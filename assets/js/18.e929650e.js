(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{374:function(t,s,a){"use strict";a.r(s);var r=a(44),n=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1、介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、介绍"}},[t._v("#")]),t._v(" 1、介绍")]),t._v(" "),a("p",[t._v("暂时没有提供 CDN 等公共静态资源服务，通过 Script 标签引入采集探针需要先下载最新的 JavaScript 文件，当前 SDK 各个版本的 JavaScript 文件随项目保存在 Git 仓库的 lib 目录下，")]),t._v(" "),a("p",[t._v("SDK 编译版本保存路径：")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("http://git.pflm.cn:8880/transfer/trigger/-/tree/master/lib\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[a("strong",[t._v("因为没有使用 CDN 等公共静态资源服务，所以后文引入 SDK 使用以下地址进行说明：")]),t._v(" 在引入实际项目中时请替换成对应的地址：")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("http://127.0.0.1:28080/dev/1.0.0-dev/trigger.min.js\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h2",{attrs:{id:"_2、引入-sdk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、引入-sdk"}},[t._v("#")]),t._v(" 2、引入 SDK")]),t._v(" "),a("p",[t._v("将最新的 JavaSvript 文件下载到项目文件夹内以后通过 JavaSvript 异步加载脚本，以免对网站的打开速度造成影响：")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" scriptElement "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    scriptElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jw-trigger"')]),t._v("\n    scriptElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:28080/trigger.min.js?type=script&variable=jw_collector&enviroment=TEST&logLevel=DEBUG"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" existedScript "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    existedScript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parentNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("scriptElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" existedScript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("p",[t._v("除了通过 JavaScript 异步加载 SDK 外还可以通过同步的方式进行加载、同步加载可能会对网页打开造成影响，"),a("strong",[t._v("不推荐使用")]),t._v("，同步加载方式如下所示：")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jw-trigger"')]),t._v(" src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:28080/trigger.min.js?type=script&variable=jw_collector&enviroment=TEST&logLevel=DEBUG"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("紧跟在 SDK JavaScript 文件 URL 后面的 "),a("strong",[t._v("type=script&variable=jw_collector&enviroment=TEST&logLevel=DEBUG")]),t._v(" 字符串是 SDK 在安装引入过程中需要使用到的参数，可以通过修改对应参数的值来实现特定的功能 ,目前 SDK 在安装过程中支持配置的参数如下：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("参数名称")]),t._v(" "),a("th",[t._v("参数说明")]),t._v(" "),a("th",[t._v("参数值")]),t._v(" "),a("th",[t._v("默认值")]),t._v(" "),a("th",[t._v("必传")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("type")]),t._v(" "),a("td",[t._v("SDK 引入方式")]),t._v(" "),a("td",[t._v("script")]),t._v(" "),a("td",[t._v("无")]),t._v(" "),a("td",[t._v("是")])]),t._v(" "),a("tr",[a("td",[t._v("variable")]),t._v(" "),a("td",[t._v("SDK 挂载对象")]),t._v(" "),a("td",[t._v("SDK 的全局对象")]),t._v(" "),a("td",[t._v("无")]),t._v(" "),a("td",[t._v("是")])]),t._v(" "),a("tr",[a("td",[t._v("enviroment")]),t._v(" "),a("td",[t._v("引入 SDK 所在的业务环境")]),t._v(" "),a("td",[t._v("DEV、TEST、UAT、PROD")]),t._v(" "),a("td",[t._v("无")]),t._v(" "),a("td",[t._v("否")])]),t._v(" "),a("tr",[a("td",[t._v("api")]),t._v(" "),a("td",[t._v("采集数据提交 API 地址")]),t._v(" "),a("td",[t._v("API 地址")]),t._v(" "),a("td",[t._v("无")]),t._v(" "),a("td",[t._v("否")])]),t._v(" "),a("tr",[a("td",[t._v("logLevel")]),t._v(" "),a("td",[t._v("SDK 内部日志等级")]),t._v(" "),a("td",[t._v("ERROR、WARN、INFO、DEBUG")]),t._v(" "),a("td",[t._v("ERROR")]),t._v(" "),a("td",[t._v("否")])])])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("type字段：SDK 加载过程中会尝试获取该参数用来判断 SDK 是否是通过 Script 标签引入的。如果该参数的值为 script 则表示 SDK 是通过 Script 标签引入，SDK 将会按照在浏览器中通过 Script 标签引入 SDK 的方式来安装采集器、采集数据和上报数据。如果该参数的值未设置或者为其他值，则 SDK 会按照 NPM 包引入的方式安装采集器、采集数据、上报数据。")])]),t._v(" "),a("li",[a("p",[t._v("variable字段：该字段用来向 SDK 表明 SDK 安装完成后需要将 SDK 全局对象挂载到 window 下的某个变量。例如：variable=jw_collector 在 SDK 安装完成后将能从 window.jw_collector 中获取到 SDK 暴露出来的自定义采集方法 record()。")])]),t._v(" "),a("li",[a("p",[t._v("enviroment字段：该字段用来设置引入 SDK 的业务环境，DEV、TEST、UAT、PROD 分别表示开发环境、测试环境、UAT 环境、正式环境，设置该值后 SDK 将向对应环境的数据提交接口提交采集数据。enviroment 字段非必传，如果没有传值则将试图获取 api 参数值。enviroment 参数与 api 参数至少需要传一个，否则将会抛出异常。")])]),t._v(" "),a("li",[a("p",[t._v("api字段：当 enviroment 字段没有传值时 SDK 将从该字段获取 SDK 采集数据的上传地址。")])]),t._v(" "),a("li",[a("p",[t._v("logLevel字段：该字段用于设置 SDK 内部的日志等级、当 SDK 输出的日志等级大于或等于该等级时将被输出，否则将不会输出。SDK 日志等级包括 ERROR、WARN、INFO、DEBUG 四个等级，其等级 ERROR > WARN > INFO > DEBUG ,所以设置日志等级为 INFO 级时 ERROR、WARN、INFO 级别的日志将会输出，DEBUG 级别的日志不会输出。")])])]),t._v(" "),a("h2",{attrs:{id:"_3、使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、使用"}},[t._v("#")]),t._v(" 3、使用")]),t._v(" "),a("p",[t._v("SDK 在被引入了以后将会自动采集设备信息、上报PV、UV，记录用户访问路径和页面停留时长。除此之外如果需要采集自定义的数据时需要使用 record() 函数。 record() 函数的声明如下：")]),t._v(" "),a("div",{staticClass:"language-typescript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n   * 记录自定义采集数据\n   * @param data 待上传采集数据\n   */")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("record")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[t._v("使用 record() 函数需要设置 variable 字段，以 variable=jw_collector 为例，SDK 安装完成后可以通过 window.jw_collector.record() 函数提交采集数据，record() 函数仅接收一个字符串类型的参数。")])])}),[],!1,null,null,null);s.default=n.exports}}]);